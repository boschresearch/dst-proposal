<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="735px" preserveAspectRatio="none" style="width:551px;height:735px;" version="1.1" viewBox="0 0 551 735" width="551px" zoomAndPan="magnify"><defs><filter height="300%" id="f1e0mw55mx57yf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="137.6641" style="stroke:#000000;stroke-width:2.0;" width="508.5" x="29" y="68.5938"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="128.5313" style="stroke:#000000;stroke-width:2.0;" width="240" x="77" y="219.2578"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="51.2656" style="stroke:#000000;stroke-width:2.0;" width="196" x="96" y="287.5234"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="211.9297" style="stroke:#000000;stroke-width:2.0;" width="483" x="8" y="360.7891"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="147.6641" style="stroke:#000000;stroke-width:2.0;" width="349" x="27" y="416.0547"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="122.5313" style="stroke:#000000;stroke-width:2.0;" width="441.5" x="96" y="585.7188"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="112" x2="112" y1="56.5938" y2="727.25"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="636.5234" style="stroke:#A80036;stroke-width:1.0;" width="10" x="107" y="90.7266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="276" x2="276" y1="56.5938" y2="727.25"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="467.8594" style="stroke:#A80036;stroke-width:1.0;" width="10" x="271" y="198.2578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="475" x2="475" y1="56.5938" y2="727.25"/><rect fill="#FFFFFF" filter="url(#f1e0mw55mx57yf)" height="451.8594" style="stroke:#A80036;stroke-width:1.0;" width="10" x="470" y="206.2578"/><rect fill="#FEFECE" filter="url(#f1e0mw55mx57yf)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="45" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="52" y="41.292">Main component</text><rect fill="#FEFECE" filter="url(#f1e0mw55mx57yf)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="164" x="192" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="150" x="199" y="24.9951">Watching Component</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="218" y="41.292">Remote or Local</text><rect fill="#FEFECE" filter="url(#f1e0mw55mx57yf)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="89" x="428.5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="435.5" y="41.292">Blockchain</text><path d="M29,68.5938 L134,68.5938 L134,75.5938 L124,85.5938 L29,85.5938 L29,68.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="137.6641" style="stroke:#000000;stroke-width:2.0;" width="508.5" x="29" y="68.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="44" y="81.6606">Funding</text><line style="stroke:#A80036;stroke-width:1.0;" x1="117" x2="159" y1="111.8594" y2="111.8594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="159" x2="159" y1="111.8594" y2="124.8594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="118" x2="159" y1="124.8594" y2="124.8594"/><polygon fill="#A80036" points="128,120.8594,118,124.8594,128,128.8594,124,124.8594" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="124" y="106.7935">Open Channel</text><polygon fill="#A80036" points="264,149.9922,274,153.9922,264,157.9922,268,153.9922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="117" x2="270" y1="153.9922" y2="153.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="124" y="148.9263">Start Watching</text><polygon fill="#A80036" points="463,194.2578,473,198.2578,463,202.2578,467,198.2578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281" x2="469" y1="198.2578" y2="198.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="288" y="178.0591">Subscribe for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="288" y="193.1919">channel events</text><path d="M77,219.2578 L208,219.2578 L208,226.2578 L198,236.2578 L77,236.2578 L77,219.2578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="128.5313" style="stroke:#000000;stroke-width:2.0;" width="240" x="77" y="219.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="92" y="232.3247">Transacting</text><line style="stroke:#A80036;stroke-width:1.0;" x1="117" x2="159" y1="262.5234" y2="262.5234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="159" x2="159" y1="262.5234" y2="275.5234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="118" x2="159" y1="275.5234" y2="275.5234"/><polygon fill="#A80036" points="128,271.5234,118,275.5234,128,279.5234,124,275.5234" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="124" y="257.4575">Off-chain transactions.</text><path d="M96,287.5234 L166,287.5234 L166,294.5234 L156,304.5234 L96,304.5234 L96,287.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="51.2656" style="stroke:#000000;stroke-width:2.0;" width="196" x="96" y="287.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="111" y="300.5903">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="181" y="299.7339">[Periodically]</text><polygon fill="#A80036" points="259,326.7891,269,330.7891,259,334.7891,263,330.7891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="117" x2="265" y1="330.7891" y2="330.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="124" y="325.7231">State with signatures</text><path d="M8,360.7891 L110,360.7891 L110,367.7891 L100,377.7891 L8,377.7891 L8,360.7891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="211.9297" style="stroke:#000000;stroke-width:2.0;" width="483" x="8" y="360.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="23" y="373.856">Dispute</text><polygon fill="#A80036" points="292,400.0547,282,404.0547,292,408.0547,288,404.0547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="469" y1="404.0547" y2="404.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="298" y="398.9888">State registered</text><path d="M27,416.0547 L97,416.0547 L97,423.0547 L87,433.0547 L27,433.0547 L27,416.0547 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="147.6641" style="stroke:#000000;stroke-width:2.0;" width="349" x="27" y="416.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="42" y="429.1216">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="112" y="428.2651">[if state is not latest]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="281" x2="323" y1="459.3203" y2="459.3203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="323" x2="323" y1="459.3203" y2="472.3203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="282" x2="323" y1="472.3203" y2="472.3203"/><polygon fill="#A80036" points="292,468.3203,282,472.3203,292,476.3203,288,472.3203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="288" y="454.2544">Refute</text><polygon fill="#A80036" points="128,497.4531,118,501.4531,128,505.4531,124,501.4531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="122" x2="270" y1="501.4531" y2="501.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="134" y="496.3872">Refuted</text><path d="M41.5,514.4531 L41.5,554.4531 L346.5,554.4531 L346.5,524.4531 L336.5,514.4531 L41.5,514.4531 " fill="#D3D3D3" filter="url(#f1e0mw55mx57yf)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M336.5,514.4531 L336.5,524.4531 L346.5,524.4531 L336.5,514.4531 " fill="#D3D3D3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="72" y="531.52">If watcher has registered a state,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="72" y="546.6528">alice can then initiate channel close.</text><path d="M96,585.7188 L181,585.7188 L181,592.7188 L171,602.7188 L96,602.7188 L96,585.7188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="122.5313" style="stroke:#000000;stroke-width:2.0;" width="441.5" x="96" y="585.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="111" y="598.7856">Close</text><polygon fill="#A80036" points="259,624.9844,269,628.9844,259,632.9844,263,628.9844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="117" x2="265" y1="628.9844" y2="628.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="124" y="623.9185">Stop watching</text><polygon fill="#A80036" points="458,654.1172,468,658.1172,458,662.1172,462,658.1172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281" x2="464" y1="658.1172" y2="658.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="288" y="653.0513">Close channel subscription</text><line style="stroke:#A80036;stroke-width:1.0;" x1="117" x2="159" y1="687.25" y2="687.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="159" x2="159" y1="687.25" y2="700.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="118" x2="159" y1="700.25" y2="700.25"/><polygon fill="#A80036" points="128,696.25,118,700.25,128,704.25,124,700.25" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="124" y="682.1841">Close channel</text><!--MD5=[59cf3ef902b2e3c500c8a7c9cf283534]
@startuml watcher
!pragma teoz true
hide footbox

participant "Main component" as main_component
participant "Watching Component\nRemote or Local" as watcher
participant "Blockchain" as blockchain

group Funding

activate main_component
main_component -> main_component: Open Channel

main_component -> watcher: Start Watching
watcher -> blockchain: Subscribe for\nchannel events
activate watcher
activate blockchain

end

group Transacting 

main_component <-> main_component: Off-chain transactions.

opt Periodically
main_component -> watcher: State with signatures
end

end

group Dispute

blockchain -> watcher: State registered

opt if state is not latest
watcher -> watcher: Refute
watcher -> main_component: Refuted
note over main_component, watcher #LightGray
If watcher has registered a state,
alice can then initiate channel close.
endnote
end

end


group Close 
main_component -> watcher: Stop watching
watcher -> blockchain: Close channel subscription
deactivate blockchain
deactivate watcher
main_component -> main_component: Close channel

end



@enduml

PlantUML version 1.2020.21(Mon Nov 30 22:10:11 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IN
--></g></svg>